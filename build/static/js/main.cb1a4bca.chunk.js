(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{16:function(e,t,n){e.exports=n(40)},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(15),c=n.n(l),o=n(1),u=n.n(o),i=n(2),s=n(4),p=n(5),d=n.n(p),m=null,f={getAll:function(){var e=Object(i.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.get("/api/blogs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(i.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:m}},e.next=3,d.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(i.a)(u.a.mark((function e(t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.put("".concat("/api/blogs","/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),setToken:function(e){m="bearer ".concat(e)},deleteBlog:function(){var e=Object(i.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:m}},e.next=3,d.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},b={login:function(){var e=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=(n(39),function(e){var t=e.message;return null===t.type?null:r.a.createElement("div",{className:"notification ".concat(t.type)},t.text)}),v=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),l=Object(s.a)(n,2),c=l[0],o=l[1],u={display:c?"none":""},i={display:c?"":"none"},p=function(){o(!c)};Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:p}}));var d=null,m=null;if(void 0!==e.children.length)d=e.children.filter((function(e){return!!e&&"hide"===e.props.initial_state})),m=e.children.filter((function(e){return!!e&&"show"===e.props.initial_state}));else if(e.children.props.initial_state){"hide"===e.children.props.initial_state?d=e.children:m=e.children}var f=e.buttonLabel2;return e.buttonLabel2||(f=e.buttonLabel1),r.a.createElement("div",{className:"toggleable-container"},r.a.createElement("div",{className:"toggleable-initially-shown",style:u},r.a.createElement("button",{onClick:p},e.buttonLabel1),m),r.a.createElement("div",{className:"toggleable-initially-hidden",style:i},r.a.createElement("button",{onClick:p},f),d))}));v.displayName="Togglable";var h=v,w=function(e){var t=e.createBlog,n=Object(a.useState)(""),l=Object(s.a)(n,2),c=l[0],o=l[1],p=Object(a.useState)(""),d=Object(s.a)(p,2),m=d[0],f=d[1],b=Object(a.useState)(""),g=Object(s.a)(b,2),v=g[0],h=g[1],w=function(){var e=Object(i.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t({title:c,author:m,url:v}),o(""),f(""),h("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"blogform-container"},r.a.createElement("h2",null,"create new"),r.a.createElement("form",{onSubmit:w},r.a.createElement("div",null,"title",r.a.createElement("input",{id:"blogform-title-input",type:"text",name:"title",value:c,onChange:function(e){var t=e.target;return o(t.value)}})),r.a.createElement("div",null,"author",r.a.createElement("input",{id:"blogform-author-input",type:"text",name:"author",value:m,onChange:function(e){var t=e.target;return f(t.value)}})),r.a.createElement("div",null,"url",r.a.createElement("input",{id:"blogform-url-input",type:"text",name:"url",value:v,onChange:function(e){var t=e.target;return h(t.value)}})),r.a.createElement("button",{className:"blogform-create-button",type:"create"},"create")))},y=function(e){var t=e.blog,n=e.updateBlog,a=e.deleteBlog,l=e.user,c=function(){return r.a.createElement("div",{className:"blog-title-and-author",initial_state:"show"}," ",t.title,", by ",t.author)},o=function(){var e=Object(i.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={author:t.author,likes:t.likes+1,title:t.title,user:t.user.id},e.next=3,n(t.id,a);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){window.confirm("Remove blog ".concat(t.title," by ").concat(t.author,"?"))&&a(t.id)},p=l.id===t.user.id;return r.a.createElement(h,{buttonLabel1:"view",buttonLabel2:"hide"},c(),r.a.createElement("div",{className:"blog-content",initial_state:"hide"},c(),r.a.createElement("div",{className:"extended-blog"},r.a.createElement("div",{className:"url-line"},t.url),r.a.createElement("div",{className:"likes-line"},"likes: ",t.likes," ",r.a.createElement("button",{onClick:o},"like")),r.a.createElement("div",{className:"creator-line"},"Entry created by: ",t.user.name))),p&&r.a.createElement("button",{className:"blog-delete-button",initial_state:"hide",onClick:s},"Delete blog"))},E=function(e){var t=e.blogs,n=e.updateBlog,a=e.deleteBlog,l=e.user,c=t.sort((function(e,t){return e.likes>t.likes?-1:e.likes<t.likes?1:0}));return r.a.createElement("div",{className:"bloglist-container"},c.map((function(e,t){return r.a.createElement("div",{className:"blog-container",key:t},r.a.createElement(y,{key:e.id,blog:e,updateBlog:n,deleteBlog:a,user:l}))})))},x=function(e){var t=e.username,n=e.password,a=e.handleUsernameChange,l=e.handlePasswordChange,c=e.handleLogin;return r.a.createElement("div",{className:"login-form"},r.a.createElement("h2",null,"Log in to application"),r.a.createElement("form",{onSubmit:c},r.a.createElement("div",null,"username",r.a.createElement("input",{className:"login-username-input",type:"text",value:t,name:"Username",onChange:a})),r.a.createElement("div",null,"password",r.a.createElement("input",{className:"login-password-input",type:"password",value:n,name:"Password",onChange:l})),r.a.createElement("button",{className:"login-button",type:"submit"},"login")))},k=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],l=t[1],c=Object(a.useState)(""),o=Object(s.a)(c,2),p=o[0],d=o[1],m=Object(a.useState)(""),v=Object(s.a)(m,2),y=v[0],k=v[1],O=Object(a.useState)(null),j=Object(s.a)(O,2),N=j[0],B=j[1],S=Object(a.useState)({type:null,text:null}),C=Object(s.a)(S,2),L=C[0],_=C[1];Object(a.useEffect)((function(){f.getAll().then((function(e){return l(e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);B(t),f.setToken(t.token)}}),[]);var U=function(){setTimeout((function(){_({type:null,text:null})}),5e3)},A=function(){var e=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,b.login({username:p,password:y});case 4:n=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),f.setToken(n.token),B(n),d(""),k(""),_({type:"success",text:"Login successful"}),U(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),_({type:"error",text:"Wrong username or password"}),U();case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),I=Object(a.useRef)(),T=function(){var e=Object(i.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,I.current.toggleVisibility(),e.next=4,f.create(t);case 4:a=e.sent,l(n.concat(a)),_({type:"success",text:'Blog "'.concat(t.title,'" added')}),U(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),_({type:"error",text:e.t0.response.data.error}),U();case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(i.a)(u.a.mark((function e(t,a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.update(t,a);case 3:r=e.sent,l(n.map((function(e){return e.id===t?r:e}))),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),_({type:"error",text:e.t0.response.data.error}),U();case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),D=function(){var e=Object(i.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.deleteBlog(t);case 3:l(n.filter((function(e){return e.id!==t}))),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),_({type:"error",text:e.t0.response.data.error}),U();case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(g,{message:L}),null===N?r.a.createElement(x,{username:p,password:y,handleUsernameChange:function(e){var t=e.target;return d(t.value)},handlePasswordChange:function(e){var t=e.target;return k(t.value)},handleLogin:A}):r.a.createElement("div",null,r.a.createElement("h2",null,"blogs"),r.a.createElement("div",{id:"logged-in-line"},N.name," logged in",r.a.createElement("button",{type:"submit",onClick:function(){if(window.confirm("Are you sure you want to logout?"))try{B(null),window.localStorage.removeItem("loggedBlogappUser"),_({type:"success",text:"Successfully logged out"}),U()}catch(e){_({type:"error",text:"Unable to logout"}),U()}}},"logout")),r.a.createElement(h,{buttonLabel1:"new blog",buttonLabel2:"cancel",ref:I},r.a.createElement(w,{initial_state:"hide",createBlog:T})),r.a.createElement(E,{blogs:n,updateBlog:J,deleteBlog:D,user:N})))};c.a.render(r.a.createElement(k,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.cb1a4bca.chunk.js.map